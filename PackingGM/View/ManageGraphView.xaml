<Page x:Class="PackingGM.View.ManageGraphView"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
      xmlns:local="clr-namespace:PackingGM.View"
      xmlns:local1="clr-namespace:PackingGM.View.Control"
      mc:Ignorable="d" 
      d:DesignHeight="450" d:DesignWidth="2000"
      Title="ManageGraphView">
    <Grid Style="{DynamicResource GridStyle}">
        <Grid.RowDefinitions>
            <RowDefinition Height="30"/>
            <RowDefinition/>
            <RowDefinition Height="30"/>
        </Grid.RowDefinitions>
        <StackPanel Grid.Row="0" Orientation="Horizontal">
            <Button Command="{Binding BackCommand}"
                    Style="{DynamicResource ButtonYesStyle}"
                    Content="Назад"
                    Width="50"
                    HorizontalAlignment="Left"/>
            <TextBlock Text="График упаковки ГМ Тара"
                       Style="{DynamicResource TextBlockHeadStyle}"
                       FontSize="20"/>
        </StackPanel>
        <ListView ItemsSource="{Binding ListGMs}"
                  SelectedItem="{Binding SelectedGMTare}"
                  Grid.Row="1">
            <ListView.View>
                <GridView>
                    <GridViewColumn Width="30">
                        <GridViewColumn.Header>
                            <TextBlock Text="№ п/п" TextWrapping="Wrap"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Number}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    
                    <!-- Колонка для  Manufactory-->
                    <GridViewColumn Width="55">
                        <GridViewColumn.Header>
                            <TextBlock Text="№ Пр-ва" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedManufactory.Number}"/>
                                    <ComboBox ItemsSource="{Binding Manufactories}"
                                              SelectedItem="{Binding SelectedManufactory}"
                                              DisplayMemberPath="Number"
                                              MinWidth="40"
                                              IsEditable="True"
                                              Visibility="Collapsed"/>
                                    <local1:ComboTextBox ItemsSource="{Binding Manufactories}"
                                                         SelectedItem="{Binding SelectedManufactory}"
                                                         DisplayMemberPath="Number"
                                                         Width="Auto"
                                                         Visibility="Collapsed"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для AggregateType-->
                    <GridViewColumn Width="95">
                        <GridViewColumn.Header>
                            <TextBlock Text="Тип изделия" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedAggregateType.Name}"
                                               TextWrapping="Wrap"
                                               MaxHeight="50"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Contragent-->
                    <GridViewColumn Width="120">
                        <GridViewColumn.Header>
                            <TextBlock Text="Контрагент" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedContragent.Name}"
                                               MaxHeight="50"
                                               TextWrapping="Wrap"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Aggregate -->
                    <GridViewColumn Width="135">
                        <GridViewColumn.Header>
                            <TextBlock Text="№ агрегата" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedAggregate.Number}"
                                               MaxHeight="50"
                                               TextWrapping="Wrap"/>
                                    <ComboBox ItemsSource="{Binding Aggregates}"
                                              SelectedItem="{Binding SelectedAggregate}"
                                              DisplayMemberPath="Number"
                                              Width="Auto"
                                              MinWidth="60"
                                              IsEditable="True"
                                              Visibility="Collapsed"/>
                                    <local1:ComboTextBox ItemsSource="{Binding Aggregates}"
                                                         SelectedItem="{Binding SelectedAggregate}"
                                                         DisplayMemberPath="Number"
                                                         Width="Auto"
                                                         MinWidth="60"
                                                         Visibility="Collapsed"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Order -->
                    <GridViewColumn Width="90">
                        <GridViewColumn.Header>
                            <TextBlock Text="№ заказа" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedOrder.Number}"
                                               MaxHeight="50"
                                               TextWrapping="Wrap"/>
                                    <ComboBox ItemsSource="{Binding Orders}"
                                              SelectedItem="{Binding SelectedOrder}"
                                              DisplayMemberPath="Number"
                                              Width="Auto"
                                              MinWidth="50"
                                              IsEditable="True"
                                              Visibility="Collapsed"/>
                                    <local1:ComboTextBox ItemsSource="{Binding Orders}"
                                                         SelectedItem="{Binding SelectedOrder}"
                                                         DisplayMemberPath="Number"
                                                         Width="Auto"
                                                         MinWidth="50"
                                                         Visibility="Collapsed"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для GM -->
                    <GridViewColumn Width="45">
                        <GridViewColumn.Header>
                            <TextBlock Text="№ ГМ" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedGMNumber.NumberGM}"/>
                                    <ComboBox ItemsSource="{Binding GMNumbers}"
                                              SelectedItem="{Binding SelectedGMNumber}"
                                              DisplayMemberPath="NumberGM"
                                              Width="Auto"
                                              IsEditable="True"
                                              Visibility="Collapsed"/>
                                    <local1:ComboTextBox ItemsSource="{Binding GMNumbers}"
                                                         SelectedItem="{Binding SelectedGMNumber}"
                                                         DisplayMemberPath="NumberGM"
                                                         MinWidth="50"
                                                         Visibility="Collapsed"/>

                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для SPU -->
                    <GridViewColumn Width="125">
                        <GridViewColumn.Header>
                            <TextBlock Text="Обозначение СПУ" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedSPU.Note}"
                                             Width="Auto"
                                             TextWrapping="Wrap"/>

                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для SPU -->
                    <GridViewColumn Width="170">
                        <GridViewColumn.Header>
                            <TextBlock Text="Наименование СПУ" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding SelectedSPU.Name}"
                                           MaxHeight="50"
                                           TextWrapping="Wrap"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Tara -->
                    <GridViewColumn Width="100">
                        <GridViewColumn.Header>
                            <TextBlock Text="Обозначение тары" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedTare.Note}"
                                               MaxHeight="50"
                                               TextWrapping="Wrap"/>
                                    <ComboBox ItemsSource="{Binding Tares}"
                                              SelectedItem="{Binding SelectedTare}"
                                              DisplayMemberPath="Note"
                                              Width="Auto"
                                              IsEditable="True"
                                              Visibility="Collapsed"/>
                                    <local1:ComboTextBox ItemsSource="{Binding Tares}"
                                                         SelectedItem="{Binding SelectedTare}"
                                                         Visibility="Collapsed"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Tara -->
                    <GridViewColumn Width="115">
                        <GridViewColumn.Header>
                            <TextBlock Text="Наименование тары" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBlock Text="{Binding SelectedTare.Name}"
                                               MaxHeight="50"
                                               TextWrapping="Wrap"/>
                                    <ComboBox ItemsSource="{Binding Tares}"
                                              SelectedItem="{Binding SelectedTare}"
                                              DisplayMemberPath="Name"
                                              Width="Auto"
                                              IsEditable="True"
                                              Visibility="Collapsed"/>
                                    <local1:ComboTextBox ItemsSource="{Binding Tares}"
                                                         SelectedItem="{Binding SelectedTare}"
                                                         Visibility="Collapsed"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для CountNeed -->
                    <GridViewColumn Width="75">
                        <GridViewColumn.Header>
                            <TextBlock Text="Кол-во потребность" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding CountNeed}"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для CountGet -->
                    <GridViewColumn Width="65">
                        <GridViewColumn.Header>
                            <TextBlock Text="Кол-во получено" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Text="{Binding CountGet}" MinWidth="20"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Dificit -->
                    <GridViewColumn Header="Дефицит" Width="55" DisplayMemberBinding="{Binding Deficit}"/>
                    
                    <!-- Колонка для DemindNumber -->
                    <GridViewColumn Width="90">
                        <GridViewColumn.Header>
                            <TextBlock Text="№ требования" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Text="{Binding Demind}"
                                         MinWidth="20"
                                         TextWrapping="Wrap"
                                         MaxHeight="50"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для DemindDate-->
                    <GridViewColumn Width="110">
                        <GridViewColumn.Header>
                            <TextBlock Text="Дата требования" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <DatePicker SelectedDate="{Binding DemindDate}"
                                                DisplayDateStart="01/01/2025"
                                                DisplayDateEnd="01/01/2050"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для PlannedDeadline -->
                    <GridViewColumn Width="110">
                        <GridViewColumn.Header>
                            <TextBlock Text="Плановый срок сдачи ГМ" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBox Text="{Binding PlannedDeadline, Mode=OneWay}" Visibility="Collapsed"/>
                                    <DatePicker SelectedDate="{Binding PlannedDeadline}"
                                                DisplayDateStart="01/01/2025"
                                                DisplayDateEnd="01/01/2050"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для GMDate2 -->
                    <GridViewColumn Width="85">
                        <GridViewColumn.Header>
                            <TextBlock Text="Необходимый срок обеспечения" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding NecessaryProvisionPeriod}"
                                           TextWrapping="Wrap"
                                           MaxHeight="50"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для GMDate3 -->
                    <GridViewColumn Width="110">
                        <GridViewColumn.Header>
                            <TextBlock Text="Обещаный срок обеспечения СМТС" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <StackPanel>
                                    <TextBox Text="{Binding PromisedProvisionPeriod, Mode=OneWay}" Visibility="Collapsed"/>
                                    <DatePicker SelectedDate="{Binding PromisedProvisionPeriod}"
                                                DisplayDateStart="01/01/2025"
                                                DisplayDateEnd="01/01/2050"/>
                                </StackPanel>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для GMPrime4anie -->
                    <GridViewColumn Width="80">
                        <GridViewColumn.Header>
                            <TextBlock Text="Примечание" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Text="{Binding Comment}"
                                         MinWidth="20"
                                         TextWrapping="Wrap"
                                         MaxHeight="50"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для GMDNackaldania -->
                    <GridViewColumn Width="70">
                        <GridViewColumn.Header>
                            <TextBlock Text="Накладная на сдачу ГМ в ООП" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding Waybill}"
                                           TextWrapping="Wrap"
                                           MaxHeight="50"
                                           MinWidth="20"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для GMDNackaldania -->
                    <GridViewColumn Width="70">
                        <GridViewColumn.Header>
                            <TextBlock Text="Дата накладной" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBlock Text="{Binding WaybillDate}"
                                           TextWrapping="Wrap"
                                           MaxHeight="50"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для SZ -->
                    <GridViewColumn Width="70">
                        <GridViewColumn.Header>
                            <TextBlock Text="Служебная записка на запуск ППО" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Text="{Binding ServiceNote}"
                                         MinWidth="20"
                                         TextWrapping="Wrap"
                                         MaxHeight="50"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Что это -->
                    <GridViewColumn Width="60">
                        <GridViewColumn.Header>
                            <TextBlock Text="№ график сдачи ГМ (ПДО)" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Text="{Binding NumberGraphPDO, Mode=OneWay}"
                                         TextWrapping="Wrap"
                                         MaxHeight="50"
                                         MinWidth="20"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                    <!-- Колонка для Резервное поле-->
                    <GridViewColumn Width="60">
                        <GridViewColumn.Header>
                            <TextBlock Text="Резервное поле" TextWrapping="Wrap" MaxHeight="50"/>
                        </GridViewColumn.Header>
                        <GridViewColumn.CellTemplate>
                            <DataTemplate>
                                <TextBox Text="{Binding ReserveField}"
                                         MinWidth="20"
                                         TextWrapping="Wrap"
                                         MaxHeight="50"/>
                            </DataTemplate>
                        </GridViewColumn.CellTemplate>
                    </GridViewColumn>
                </GridView>
            </ListView.View>
        </ListView>
        <Grid Grid.Row="2">
            <Grid.ColumnDefinitions>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
                <ColumnDefinition/>
            </Grid.ColumnDefinitions>
            <Button Style="{DynamicResource ButtonYesStyle}"
                    Command="{Binding AddGMCommand}"
                    Grid.Column="0"
                    Content="Добавить"/>
            <Button Style="{DynamicResource ButtonNoStyle}"
                    Command="{Binding DeleteGMCommand}"
                    Grid.Column="1"
                    Width="Auto"
                    Content="Удалить"/>
            <Button Style="{DynamicResource ButtonYesStyle}"
                    Command="{Binding SaveCommand}"
                    Grid.Column="2"
                    Width="Auto"
                    Content="Сохранить"/>
            <Button Style="{DynamicResource ButtonYesStyle}"
                    Command="{Binding LoadListGMCommand}"
                    Grid.Column="3"
                    Width="Auto"
                    Content="Загрузить список"/>
        </Grid>
    </Grid>
</Page>
